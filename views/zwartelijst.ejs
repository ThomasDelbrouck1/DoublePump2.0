<%- include('partials/header.ejs') %>

  <body class="avatarbody">
    <!-- Nav -->
    <header class="navbar">
      <nav>
        <section class="navContainer">
          <section>
            <img class="logo" src="/assets/_c329f736-c0ec-4f70-b64f-db3066f2d096.jpg" alt="logo" />
            <p>DOUBLEPUMP</p>
          </section>
          <ul class="navbar-nav">
            <li>
              <a href="/avatar"><i class="bx bx-male-female"></i> Personages</a>
            </li>
            <li>
              <a href="/favorieten"><i class="bx bxs-heart"></i> Favorieten</a>
            </li>
            <li>
              <a class="active" href="/zwartelijst"><i class="bx bxs-x-circle"></i> Zwarte lijst</a>
            </li>
            <li class="profile">
              <img src="<%= profilePicture %>" alt="Profile Picture" class="profile-picture-nav">
              <a href="/profiel">
                <%= username %>
              </a>
            </li>
          </ul>
        </section>
      </nav>
    </header>
    <main>

      <% const fortniteTiers={ "Common" : "rgba(128, 128, 128, 1)" , "Uncommon" : "rgba(0, 128, 0, 1)" , "Rare"
        : "rgba(0, 0, 255, 1)" , "Epic" : "rgba(128, 0, 128, 1)" , "Legendary" : "rgba(255, 165, 0, 1)" , "Mythic"
        : "rgba(255, 215, 0, 1)" , "Exotic" : "rgba(0, 255, 255, 1)" , "Transcendent" : "rgba(255, 255, 179, 1)"
        , "Marvel Series" : "rgba(139, 0, 0, 1)" , "Dark Series" : "rgba(255, 0, 255, 1)" , "DC Series"
        : "rgba(112, 128, 144, 1)" , "Icon Series" : "rgba(0, 255, 255, 1)" , "Frozen Series" : "rgba(173,216,230, 1)"
        , "Lava Series" : "rgba(255, 140, 0, 1)" , "Star Wars Series" : "rgba(0, 0, 139, 1)" , "Shadow Series"
        : "rgba(0, 0, 0, 1)" , "Slurp Series" : "rgba(0, 139, 139, 1)" , "Gaming Legends Series" : "rgba(75, 0, 130, 1)"
        , }; %>

        <div class="zwarte-search-container">
          <form action="/zwartelijst" method="get" class="search-form">
            <input type="text" name="avatarName" placeholder="Zoeken naar avatar " value="<%= avatarName %>"
              class="search-input">
            <button type="submit" class="search-button">Zoeken</button>
          </form>
        </div>

        <section class="avatars">
          <% for (let i=0; i < charactersBlack.length; i++) { %>
            <article class="avatar">
              <a href="#" data-bs-target="#myModal" data-bs-toggle="modal"
                onclick="getCharacterDetails('<%= charactersBlack[i].item.id %>')">
                <% if (charactersBlack[i].item.series && charactersBlack[i].item.series.id) { %>
                  <img src="<%= charactersBlack[i].item.images.icon %>"
                    style="background-image: url('https://media.fortniteapi.io/images/textures/<%= charactersBlack[i].item.series.id %>.png'); background-position: center; background-size: contain; background-repeat: no-repeat;"
                    alt="<%= charactersBlack[i].item.name %>" />
                  <% } else { %>
                    <img src="<%= charactersBlack[i].item.images.icon %>"
                      style="background-color: <%= fortniteTiers[charactersBlack[i].item.rarity.id] %>;background-position: center;"
                      alt="<%= charactersBlack[i].item.name %>" />
                    <% } %>
              </a>

              <p>
                <%= charactersBlack[i].item.name %>
              </p>
            </article>
            <% } %>
        </section>
    </main>

    <section class="modal fade" id="myModal" tabindex="-1" aria-labelledby="loginLabel" aria-hidden="true">
      <article class="modal-dialog zwartelijst-modal-dialog">
        <article class="modal-content">
          <section class="modal-header">
            <button type="button" class="btn-close bg-light" data-bs-dismiss="modal" aria-label="Close"></button>
          </section>
          <section class="zwarteModal-body">
            <section>
              <h2 id="modal-title"></h2>
              <video id="modal-video" width="450px" height="450px" loop autoplay playsline>
                <!-- Voeg 'controls' als attribuut om bv te kunnen pauzeren -->
                <source src="">
              </video>
            </section>
            <section id="modal-description">
              <p>Reden van Eliminatie:</p>
              <textarea id="input-text" rows="4" cols="50" placeholder="typ hier..."></textarea>
            </section>
          </section>
          <footer class="modal-footer">
            <button type="button" class="btn btn-primary">Opslaan</button>
            <button type="button" class="btn btn-danger">Verwijderen</button>
          </footer>
        </article>
      </article>
    </section>

    <button onclick="topFunction()" id="myBtn" title="Go to top">
      <i class="bx bxs-up-arrow"></i>
    </button>

    <script>
      async function getCharacterDetails(id) {
        // Reset modal fields
        document.getElementById('modal-video').src = '';
        // Fetch character details
        await fetch(`/api/characters/${id}`)
          .then(response => response.json())
          .then(data => {
            document.getElementById('modal-title').innerText = data.item.name;
            document.getElementById('modal-video').src = data.item.previewVideos[0].url;
          });
      }
    </script>
  </body>

  </html>